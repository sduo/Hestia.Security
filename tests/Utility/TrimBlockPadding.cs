using Microsoft.VisualStudio.TestTools.UnitTesting;
using System;
using System.Collections.Generic;
using System.Diagnostics.CodeAnalysis;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace Hestia.Security.Tests.Utility
{
    [TestClass]
    [ExcludeFromCodeCoverage]
    public sealed class TrimBlockPadding
    {
        public const string source = "303936303638383933326334376566310000011C3C786D6C3E3C546F557365724E616D653E3C215B43444154415B7778353832336266393664336264353663375D5D3E3C2F546F557365724E616D653E0A3C46726F6D557365724E616D653E3C215B43444154415B6D796372656174655D5D3E3C2F46726F6D557365724E616D653E0A3C43726561746554696D653E313430393635393831333C2F43726561746554696D653E0A3C4D7367547970653E3C215B43444154415B746578745D5D3E3C2F4D7367547970653E0A3C436F6E74656E743E3C215B43444154415B68656C6C6F5D5D3E3C2F436F6E74656E743E0A3C4D736749643E343536313235353335343235313334353932393C2F4D736749643E0A3C4167656E7449443E3231383C2F4167656E7449443E0A3C2F786D6C3E7778353832336266393664336264353663371E1E1E1E1E1E1E1E1E1E1E1E1E1E1E1E1E1E1E1E1E1E1E1E1E1E1E1E1E1E";
        public const string target = "303936303638383933326334376566310000011C3C786D6C3E3C546F557365724E616D653E3C215B43444154415B7778353832336266393664336264353663375D5D3E3C2F546F557365724E616D653E0A3C46726F6D557365724E616D653E3C215B43444154415B6D796372656174655D5D3E3C2F46726F6D557365724E616D653E0A3C43726561746554696D653E313430393635393831333C2F43726561746554696D653E0A3C4D7367547970653E3C215B43444154415B746578745D5D3E3C2F4D7367547970653E0A3C436F6E74656E743E3C215B43444154415B68656C6C6F5D5D3E3C2F436F6E74656E743E0A3C4D736749643E343536313235353335343235313334353932393C2F4D736749643E0A3C4167656E7449443E3231383C2F4167656E7449443E0A3C2F786D6C3E777835383233626639366433626435366337";
        
        [TestMethod]
        public void Test1()
        {
           Assert.AreEqual(target,Convert.ToHexString( Security.Utility.TrimBlockPadding(Convert.FromHexString(source))));
        }

        [TestMethod]
        public void Test2()
        {
            Assert.AreEqual("01020304050607080910", Convert.ToHexString(Security.Utility.TrimBlockPadding(Convert.FromHexString("01020304050607080910"),8)));
        }
    }
}
